# General Notes

Use Burp Suite extension Param Miner to scan unkeyed inputs.

Try multiple/a combination of headers with web cache poisoning, i.e. -   `X-Forwarded-Host: YOURID.burpcollaborator.net` and `X-Forwarded-Scheme` header is set to anything other than `HTTPS`.
- From https://portswigger.net/web-security/web-cache-poisoning/exploiting-design-flaws/lab-web-cache-poisoning-with-multiple-headers

Also try `X-Host` or `X-Forwarded-Host` to test URL overrides in server responses. 
- From: https://portswigger.net/web-security/web-cache-poisoning/exploiting-design-flaws/lab-web-cache-poisoning-targeted-using-an-unknown-header

Use the `Pragma: x-get-cache-key` header to display the cache key in the response.

Websites often exclude certain UTM analytics parameters from the cache key. Test for UTM parameters like `utm_content`.
- From: https://portswigger.net/web-security/web-cache-poisoning/exploiting-implementation-flaws/lab-web-cache-poisoning-unkeyed-param

### Using web cache poisoning to deliver an XSS attack

- From: https://portswigger.net/web-security/web-cache-poisoning/exploiting-design-flaws

Here, the value of the `X-Forwarded-Host` header is being used to dynamically generate an Open Graph image URL, which is then reflected in the response. Crucially for web cache poisoning, the `X-Forwarded-Host` header is often unkeyed. In this example, the cache can potentially be poisoned with a response containing a simple XSS payload:

```http
GET /en?region=uk HTTP/1.1
Host: innocent-website.com
X-Forwarded-Host: a."><script>alert(1)</script>"

HTTP/1.1 200 OK
Cache-Control: public
<meta property="og:image" content="https://a."><script>alert(1)</script>"/cms/social.png" />
```

If this response was cached, all users who accessed `/en?region=uk` would be served this XSS payload. 

