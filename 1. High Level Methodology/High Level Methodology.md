**Transport Layer**

- Encryption (sslscan/testssl.sh)
- Presence of the HTTP `Strict-Transport-Security` Header
- Check for redirection all unencrypted traffic to encrypted

**Information Leakage**

Look for:

- Software versions: Server/Framework/Language/Libraries
- Configuration Files
- Source code disclosures
- Log files
- Path disclosures
- Password Hashes
- Username disclosure
- Stack traces
- Internal IP addresses/Hostnames
- Emails
- PII
- Financial information

**Sessions**

- Secure session tokens (Use Burp's Sequencer for testing entropy of cookies set)
- Tokens are not re-used (session fixation, CSRF token reuse, password reset token reuse, 2FA tokens)
- Check session expiration limit
- Session destruction
    - Check if sessions are destroyed on the server, not just deleted in the browser. Resend requests in Burp with "logged-out" cookies to test if cookies are still accepted server-side. 
- Check if `secure`  flag is set on all session cookies (prevents the browser from sending cookies over unencrypted HTTP)
- Check if `HttpOnly`flag is set on all session cookies (prevents XSS attacks from accessing cookies)
- Session data is stored server-side and not in the cookie (excludes ViewStates, JWTs - see next item)
- Client-stored session information (i.e. ViewStates, JWTs) is cryptographically protected
    - If so, check if:
        - HMAC uses a strong secret (can attempt to brute force w/ hashcat)
        - Encrypted tokens use a strong algorithm/secret
- Sessions are invalidated after IP change (optional, but good practice for high security)

**Authentication**

- Uses encrypted channels
- Does not distinguish between invalid usernames or invalid passwords (info disclosure) - Server responses remain the same
- Requires at least username/password (1FA)
- Supports two factor authentication (2FA) if required by compliance/company policy
- Accounts lock after a defined number of failed login attempts
    - Users are notified of account lockouts
- Password complexity is enforced to industry standard minimums
    - At least 8 characters in length
    - Must contain at least one digit
    - Must contain at least one special character
    - Cannot be the same as the username
    - Cannot be the same as the user's email
- Passwords are obscured when entering
- Passwords cannot be blank
- User identifiers are unique
- Test RBAC enforcement
    - Users cannot access other user data
    - Users cannot access admin functionality
    - Users cannot edit other user data
    - Users cannot brute-force data identifiers

**Account Management**

- Users are notified on account updates
    - Email change (notification sent to both old and new)
    - Password change
- Passwords expire after defined period
    - Users are notified on password expiration
- Password resets do not reveal account information (i.e. partially obscured emails, te**********st@test.com)
- Password changes require authentication
- Password changes require the old password
- Users cannot register a new account with the same name as an existing account
- Default accounts have had passwords changed

**Administration**

- Administrative consoles are not exposed (varies by application/technology)
- Users are not administrators
- Authentication is required for administrative activities
- Unauthorized users cannot access administrative functions
- Application passwords are not exposed (i.e. connection strings)

**Configuration**

- No unnecessary services are exposed (like admin panels on 8080/8443, etc)
- Firewalls are enabled and configured correctly
- Application components are up-to-date
- Directory indexing not enabled
- Source code cannot be disclosed
- Source code backups do not exist (i.e. index.php~ or index.php.bak)
- Minimum permissions are used for system components (i.e. not using 'sa' or 'root' for database access, or running as 'root' for the application software)
- Load balancers do not expose internal IPs

**Application**

- Cross Site Request Forgery
    - CSRF protections are implemented
    - CSRF tokens are strictly validated in every case before the relevant action is executed.
    - CSRF protections cannot be bypassed by removing the tokens
    - CSRF protections cannot be bypassed by using invalid tokens
    - CSRF protections cannot be bypassed using another user's valid token (must be tied to each user's session)
    - CSRF protections are unpredictable with high entropy
- robots.txt
    - No sensitive information is disclosed (such as /private, /logs etc.)
- Pages require authentication where necessary
- Pages honor POST vs GET requests (i.e. you cannot swap a GET to a POST)
- User controlled data is not used in a serialized fashion (i.e., user controlled data stored/sent in a deserialized Java object)
- Known formats are processed (i.e. Endpoints only accept `application/x-www-form-urlencoded` or `application/json`, and JSON endpoints do not accept XML)

**Application tests**

Parameter testing:

- Test for unkeyed parameters (use Param Miner)
- Test each query parameter (where possible) for SQLi
- Test each query parameter (where possible) for XSS
- Test each query parameter (where possible) for Command Injection
- Test each query parameter (where possible) for HPP (HTTP Parameter Pollution)
- Test each query parameter (where possible) for Null byte injection (all variants)
- Test each query parameter (where possible) for Path manipulation
- Test each query parameter (where possible) for directory traversal
- Test each query parameter (where possible) for XML/XXE attacks
- Test each query parameter (where possible) for Type errors (converting to arrays, vs integers, vs strings)
- Test each query parameter (where possible) for SSI (Server Side Includes)
- Test each query parameter (where possible) for SSTI (Server Side Template Injection)

Header testing:
- Test for unkeyed headers (use Param Miner)
- Supply an arbitrary Host header
- 

File upload testing:
- 

CORS testing:
- 

Websocket testing:
- 

DOM-based vulnerability testing:
- 

Web Cache Poisioning
- 

**OSINT**

- Google dorks (`site:target_app.example.com filetype:pdf` etc.)
- Github
- Forums
- User Guides
- Default configurations
- Default credentials
- Known vulnerabilities
- Patterns in disclosed vulnerabilities
- DNS
- Webservers (https://crt.sh/ is a fantastic resource)